netstat -np >>>>> gives you port list
probmod >>>>> all the kernal modules 
RBAC kubectl auth can-i --list --as=system:serviceaccount:omni:frontend   list all the verb that serviceaccount can do 
APPARMOR For loading apparmor go to the doc file and place the command and mention it in the security context the recreate pod it will take the profile from local host and we can mention it as runtime default 
FALCO remember the path /etc/falco/falco rules for the rules file 
********************************
For PSP pod security policy make sure all these are mentioned and pod is running check for the kubectl get deploy in yaml file and see the message out of it for the hint 
spec:
  securityContext:
    runAsNonRoot: true
    seccompProfile:
      type: RuntimeDefault
  containers:
  - name: app
    image: nginx
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - ALL
      readOnlyRootFilesystem: true
************************************

Kubebench >>> kube-bench -h and navigate the config file get it ready 
make the coreection nessarry and fix it 

For falco if there is rule we need to edit it to means we can copy the rule form default file and place in local file and make the log to be recoreded in the other path inside the falco.yaml file 
the restart the falco service and check useing journalclt -u falco command 
**************************************
Question*************
We need to ensure that when pods are created in this cluster, they cannot use the latest image tag, irrespective of the repository being used.

To achieve this, a simple Admission Webhook Server has been developed and deployed. A service called image-bouncer-webhook is deployed in the cluster. This Webhook server ensures that the developers of the team cannot use the latest image tag. Use the following specs to integrate it with the cluster using an ImagePolicyWebhook:

    Create a new admission configuration file at /etc/admission-controllers/admission-configuration.yaml

    The kubeconfig file with the credentials to connect to the webhook server is located at /root/CKS/ImagePolicy/admission-kubeconfig.yaml. Note: The /root/CKS/ImagePolicy/ directory is already mounted on the kube-apiserver at path /etc/admission-controllers, so reference that path in reference the admission configuration.

    Ensure that if the latest tag is used, the request must be rejected at all times.

    Enable the Admission Controller.


Finally, delete the existing pod in the magnum namespace that violates the policy and recreate it, ensuring the same image but using tag 1.27.
